import { getXHRResponse } from './getXHRResponse.mjs';
/**
 * A normalized response from an AJAX request. To get the data from the response,
 * you will want to read the `response` property.
 *
 * - DO NOT create instances of this class directly.
 * - DO NOT subclass this class.
 *
 * It is advised not to hold this object in memory, as it has a reference to
 * the original XHR used to make the request, as well as properties containing
 * request and response data.
 *
 * @see {@link ajax}
 * @see {@link AjaxConfig}
 */
export class AjaxResponse {
    /**
     * A normalized response from an AJAX request. To get the data from the response,
     * you will want to read the `response` property.
     *
     * - DO NOT create instances of this class directly.
     * - DO NOT subclass this class.
     *
     * @param originalEvent The original event object from the XHR `onload` event.
     * @param xhr The `XMLHttpRequest` object used to make the request. This is useful for examining status code, etc.
     * @param request The request settings used to make the HTTP request.
     * @param type The type of the event emitted by the {@link ajax} Observable
     */
    constructor(
    /**
     * The original event object from the raw XHR event.
     */
    originalEvent, 
    /**
     * The XMLHttpRequest object used to make the request.
     * NOTE: It is advised not to hold this in memory, as it will retain references to all of it's event handlers
     * and many other things related to the request.
     */
    xhr, 
    /**
     * The request parameters used to make the HTTP request.
     */
    request, 
    /**
     * The event type. This can be used to discern between different events
     * if you're using progress events with {@link includeDownloadProgress} or
     * {@link includeUploadProgress} settings in {@link AjaxConfig}.
     *
     * The event type consists of two parts: the {@link AjaxDirection} and the
     * the event type. Merged with `_`, they form the `type` string. The
     * direction can be an `upload` or a `download` direction, while an event can
     * be `loadstart`, `progress` or `load`.
     *
     * `download_load` is the type of event when download has finished and the
     * response is available.
     */
    type = 'download_load') {
        this.originalEvent = originalEvent;
        this.xhr = xhr;
        this.request = request;
        this.type = type;
        const { status, responseType } = xhr;
        this.status = status !== null && status !== void 0 ? status : 0;
        this.responseType = responseType !== null && responseType !== void 0 ? responseType : '';
        // Parse the response headers in advance for the user. There's really
        // not a great way to get all of them. So we need to parse the header string
        // we get back. It comes in a simple enough format:
        //
        // header-name: value here
        // content-type: application/json
        // other-header-here: some, other, values, or, whatever
        const allHeaders = xhr.getAllResponseHeaders();
        this.responseHeaders = allHeaders
            ? // Split the header text into lines
                allHeaders.split('\n').reduce((headers, line) => {
                    // Split the lines on the first ": " as
                    // "key: value". Note that the value could
                    // technically have a ": " in it.
                    const index = line.indexOf(': ');
                    headers[line.slice(0, index)] = line.slice(index + 2);
                    return headers;
                }, {})
            : {};
        this.response = getXHRResponse(xhr);
        const { loaded, total } = originalEvent;
        this.loaded = loaded;
        this.total = total;
    }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9hamF4L0FqYXhSZXNwb25zZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFbEQ7Ozs7Ozs7Ozs7Ozs7R0FhRztBQUNILE1BQU0sT0FBTyxZQUFZO0lBbUN2Qjs7Ozs7Ozs7Ozs7T0FXRztJQUNIO0lBQ0U7O09BRUc7SUFDYSxhQUE0QjtJQUM1Qzs7OztPQUlHO0lBQ2EsR0FBbUI7SUFDbkM7O09BRUc7SUFDYSxPQUFvQjtJQUNwQzs7Ozs7Ozs7Ozs7O09BWUc7SUFDYSxPQUF5QixlQUFlO1FBeEJ4QyxrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQU01QixRQUFHLEdBQUgsR0FBRyxDQUFnQjtRQUluQixZQUFPLEdBQVAsT0FBTyxDQUFhO1FBY3BCLFNBQUksR0FBSixJQUFJLENBQW9DO1FBRXhELE1BQU0sRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLEdBQUcsR0FBRyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxhQUFOLE1BQU0sY0FBTixNQUFNLEdBQUksQ0FBQyxDQUFDO1FBQzFCLElBQUksQ0FBQyxZQUFZLEdBQUcsWUFBWSxhQUFaLFlBQVksY0FBWixZQUFZLEdBQUksRUFBRSxDQUFDO1FBRXZDLHFFQUFxRTtRQUNyRSw0RUFBNEU7UUFDNUUsbURBQW1EO1FBQ25ELEVBQUU7UUFDRiwwQkFBMEI7UUFDMUIsaUNBQWlDO1FBQ2pDLHVEQUF1RDtRQUN2RCxNQUFNLFVBQVUsR0FBRyxHQUFHLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUMvQyxJQUFJLENBQUMsZUFBZSxHQUFHLFVBQVU7WUFDL0IsQ0FBQyxDQUFDLG1DQUFtQztnQkFDbkMsVUFBVSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUErQixFQUFFLElBQUksRUFBRSxFQUFFO29CQUN0RSx1Q0FBdUM7b0JBQ3ZDLDBDQUEwQztvQkFDMUMsaUNBQWlDO29CQUNqQyxNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO29CQUNqQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQztvQkFDdEQsT0FBTyxPQUFPLENBQUM7Z0JBQ2pCLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDUixDQUFDLENBQUMsRUFBRSxDQUFDO1FBRVAsSUFBSSxDQUFDLFFBQVEsR0FBRyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDcEMsTUFBTSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRyxhQUFhLENBQUM7UUFDeEMsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDckIsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7SUFDckIsQ0FBQztDQUNGIiwiZmlsZSI6Im5vZGVfbW9kdWxlcy9yeGpzL3NyYy9pbnRlcm5hbC9hamF4L0FqYXhSZXNwb25zZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFqYXhSZXF1ZXN0LCBBamF4UmVzcG9uc2VUeXBlIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBnZXRYSFJSZXNwb25zZSB9IGZyb20gJy4vZ2V0WEhSUmVzcG9uc2UnO1xuXG4vKipcbiAqIEEgbm9ybWFsaXplZCByZXNwb25zZSBmcm9tIGFuIEFKQVggcmVxdWVzdC4gVG8gZ2V0IHRoZSBkYXRhIGZyb20gdGhlIHJlc3BvbnNlLFxuICogeW91IHdpbGwgd2FudCB0byByZWFkIHRoZSBgcmVzcG9uc2VgIHByb3BlcnR5LlxuICpcbiAqIC0gRE8gTk9UIGNyZWF0ZSBpbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBkaXJlY3RseS5cbiAqIC0gRE8gTk9UIHN1YmNsYXNzIHRoaXMgY2xhc3MuXG4gKlxuICogSXQgaXMgYWR2aXNlZCBub3QgdG8gaG9sZCB0aGlzIG9iamVjdCBpbiBtZW1vcnksIGFzIGl0IGhhcyBhIHJlZmVyZW5jZSB0b1xuICogdGhlIG9yaWdpbmFsIFhIUiB1c2VkIHRvIG1ha2UgdGhlIHJlcXVlc3QsIGFzIHdlbGwgYXMgcHJvcGVydGllcyBjb250YWluaW5nXG4gKiByZXF1ZXN0IGFuZCByZXNwb25zZSBkYXRhLlxuICpcbiAqIEBzZWUge0BsaW5rIGFqYXh9XG4gKiBAc2VlIHtAbGluayBBamF4Q29uZmlnfVxuICovXG5leHBvcnQgY2xhc3MgQWpheFJlc3BvbnNlPFQ+IHtcbiAgLyoqIFRoZSBIVFRQIHN0YXR1cyBjb2RlICovXG4gIHJlYWRvbmx5IHN0YXR1czogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgcmVzcG9uc2UgZGF0YSwgaWYgYW55LiBOb3RlIHRoYXQgdGhpcyB3aWxsIGF1dG9tYXRpY2FsbHkgYmUgY29udmVydGVkIHRvIHRoZSBwcm9wZXIgdHlwZVxuICAgKi9cbiAgcmVhZG9ubHkgcmVzcG9uc2U6IFQ7XG5cbiAgLyoqXG4gICAqIFRoZSByZXNwb25zZVR5cGUgc2V0IG9uIHRoZSByZXF1ZXN0LiAoRm9yIGV4YW1wbGU6IGBcIlwiYCwgYFwiYXJyYXlidWZmZXJcImAsIGBcImJsb2JcImAsIGBcImRvY3VtZW50XCJgLCBgXCJqc29uXCJgLCBvciBgXCJ0ZXh0XCJgKVxuICAgKiBAZGVwcmVjYXRlZCBUaGVyZSBpc24ndCBtdWNoIHJlYXNvbiB0byBleGFtaW5lIHRoaXMuIEl0J3MgdGhlIHNhbWUgcmVzcG9uc2VUeXBlIHNldCAob3IgZGVmYXVsdGVkKSBvbiB0aGUgYWpheCBjb25maWcuXG4gICAqIElmIHlvdSByZWFsbHkgbmVlZCB0byBleGFtaW5lIHRoaXMgdmFsdWUsIHlvdSBjYW4gY2hlY2sgaXQgb24gdGhlIGByZXF1ZXN0YCBvciB0aGUgYHhocmAuIFdpbGwgYmUgcmVtb3ZlZCBpbiB2OC5cbiAgICovXG4gIHJlYWRvbmx5IHJlc3BvbnNlVHlwZTogWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGU7XG5cbiAgLyoqXG4gICAqIFRoZSB0b3RhbCBudW1iZXIgb2YgYnl0ZXMgbG9hZGVkIHNvIGZhci4gVG8gYmUgdXNlZCB3aXRoIHtAbGluayB0b3RhbH0gd2hpbGVcbiAgICogY2FsY3VsYXRpbmcgcHJvZ3Jlc3MuIChZb3Ugd2lsbCB3YW50IHRvIHNldCB7QGxpbmsgaW5jbHVkZURvd25sb2FkUHJvZ3Jlc3N9IG9yXG4gICAqIHtAbGluayBpbmNsdWRlRG93bmxvYWRQcm9ncmVzc30pXG4gICAqL1xuICByZWFkb25seSBsb2FkZWQ6IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIHRvdGFsIG51bWJlciBvZiBieXRlcyB0byBiZSBsb2FkZWQuIFRvIGJlIHVzZWQgd2l0aCB7QGxpbmsgbG9hZGVkfSB3aGlsZVxuICAgKiBjYWxjdWxhdGluZyBwcm9ncmVzcy4gKFlvdSB3aWxsIHdhbnQgdG8gc2V0IHtAbGluayBpbmNsdWRlRG93bmxvYWRQcm9ncmVzc30gb3JcbiAgICoge0BsaW5rIGluY2x1ZGVEb3dubG9hZFByb2dyZXNzfSlcbiAgICovXG4gIHJlYWRvbmx5IHRvdGFsOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIEEgZGljdGlvbmFyeSBvZiB0aGUgcmVzcG9uc2UgaGVhZGVycy5cbiAgICovXG4gIHJlYWRvbmx5IHJlc3BvbnNlSGVhZGVyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcblxuICAvKipcbiAgICogQSBub3JtYWxpemVkIHJlc3BvbnNlIGZyb20gYW4gQUpBWCByZXF1ZXN0LiBUbyBnZXQgdGhlIGRhdGEgZnJvbSB0aGUgcmVzcG9uc2UsXG4gICAqIHlvdSB3aWxsIHdhbnQgdG8gcmVhZCB0aGUgYHJlc3BvbnNlYCBwcm9wZXJ0eS5cbiAgICpcbiAgICogLSBETyBOT1QgY3JlYXRlIGluc3RhbmNlcyBvZiB0aGlzIGNsYXNzIGRpcmVjdGx5LlxuICAgKiAtIERPIE5PVCBzdWJjbGFzcyB0aGlzIGNsYXNzLlxuICAgKlxuICAgKiBAcGFyYW0gb3JpZ2luYWxFdmVudCBUaGUgb3JpZ2luYWwgZXZlbnQgb2JqZWN0IGZyb20gdGhlIFhIUiBgb25sb2FkYCBldmVudC5cbiAgICogQHBhcmFtIHhociBUaGUgYFhNTEh0dHBSZXF1ZXN0YCBvYmplY3QgdXNlZCB0byBtYWtlIHRoZSByZXF1ZXN0LiBUaGlzIGlzIHVzZWZ1bCBmb3IgZXhhbWluaW5nIHN0YXR1cyBjb2RlLCBldGMuXG4gICAqIEBwYXJhbSByZXF1ZXN0IFRoZSByZXF1ZXN0IHNldHRpbmdzIHVzZWQgdG8gbWFrZSB0aGUgSFRUUCByZXF1ZXN0LlxuICAgKiBAcGFyYW0gdHlwZSBUaGUgdHlwZSBvZiB0aGUgZXZlbnQgZW1pdHRlZCBieSB0aGUge0BsaW5rIGFqYXh9IE9ic2VydmFibGVcbiAgICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBvcmlnaW5hbCBldmVudCBvYmplY3QgZnJvbSB0aGUgcmF3IFhIUiBldmVudC5cbiAgICAgKi9cbiAgICBwdWJsaWMgcmVhZG9ubHkgb3JpZ2luYWxFdmVudDogUHJvZ3Jlc3NFdmVudCxcbiAgICAvKipcbiAgICAgKiBUaGUgWE1MSHR0cFJlcXVlc3Qgb2JqZWN0IHVzZWQgdG8gbWFrZSB0aGUgcmVxdWVzdC5cbiAgICAgKiBOT1RFOiBJdCBpcyBhZHZpc2VkIG5vdCB0byBob2xkIHRoaXMgaW4gbWVtb3J5LCBhcyBpdCB3aWxsIHJldGFpbiByZWZlcmVuY2VzIHRvIGFsbCBvZiBpdCdzIGV2ZW50IGhhbmRsZXJzXG4gICAgICogYW5kIG1hbnkgb3RoZXIgdGhpbmdzIHJlbGF0ZWQgdG8gdGhlIHJlcXVlc3QuXG4gICAgICovXG4gICAgcHVibGljIHJlYWRvbmx5IHhocjogWE1MSHR0cFJlcXVlc3QsXG4gICAgLyoqXG4gICAgICogVGhlIHJlcXVlc3QgcGFyYW1ldGVycyB1c2VkIHRvIG1ha2UgdGhlIEhUVFAgcmVxdWVzdC5cbiAgICAgKi9cbiAgICBwdWJsaWMgcmVhZG9ubHkgcmVxdWVzdDogQWpheFJlcXVlc3QsXG4gICAgLyoqXG4gICAgICogVGhlIGV2ZW50IHR5cGUuIFRoaXMgY2FuIGJlIHVzZWQgdG8gZGlzY2VybiBiZXR3ZWVuIGRpZmZlcmVudCBldmVudHNcbiAgICAgKiBpZiB5b3UncmUgdXNpbmcgcHJvZ3Jlc3MgZXZlbnRzIHdpdGgge0BsaW5rIGluY2x1ZGVEb3dubG9hZFByb2dyZXNzfSBvclxuICAgICAqIHtAbGluayBpbmNsdWRlVXBsb2FkUHJvZ3Jlc3N9IHNldHRpbmdzIGluIHtAbGluayBBamF4Q29uZmlnfS5cbiAgICAgKlxuICAgICAqIFRoZSBldmVudCB0eXBlIGNvbnNpc3RzIG9mIHR3byBwYXJ0czogdGhlIHtAbGluayBBamF4RGlyZWN0aW9ufSBhbmQgdGhlXG4gICAgICogdGhlIGV2ZW50IHR5cGUuIE1lcmdlZCB3aXRoIGBfYCwgdGhleSBmb3JtIHRoZSBgdHlwZWAgc3RyaW5nLiBUaGVcbiAgICAgKiBkaXJlY3Rpb24gY2FuIGJlIGFuIGB1cGxvYWRgIG9yIGEgYGRvd25sb2FkYCBkaXJlY3Rpb24sIHdoaWxlIGFuIGV2ZW50IGNhblxuICAgICAqIGJlIGBsb2Fkc3RhcnRgLCBgcHJvZ3Jlc3NgIG9yIGBsb2FkYC5cbiAgICAgKlxuICAgICAqIGBkb3dubG9hZF9sb2FkYCBpcyB0aGUgdHlwZSBvZiBldmVudCB3aGVuIGRvd25sb2FkIGhhcyBmaW5pc2hlZCBhbmQgdGhlXG4gICAgICogcmVzcG9uc2UgaXMgYXZhaWxhYmxlLlxuICAgICAqL1xuICAgIHB1YmxpYyByZWFkb25seSB0eXBlOiBBamF4UmVzcG9uc2VUeXBlID0gJ2Rvd25sb2FkX2xvYWQnXG4gICkge1xuICAgIGNvbnN0IHsgc3RhdHVzLCByZXNwb25zZVR5cGUgfSA9IHhocjtcbiAgICB0aGlzLnN0YXR1cyA9IHN0YXR1cyA/PyAwO1xuICAgIHRoaXMucmVzcG9uc2VUeXBlID0gcmVzcG9uc2VUeXBlID8/ICcnO1xuXG4gICAgLy8gUGFyc2UgdGhlIHJlc3BvbnNlIGhlYWRlcnMgaW4gYWR2YW5jZSBmb3IgdGhlIHVzZXIuIFRoZXJlJ3MgcmVhbGx5XG4gICAgLy8gbm90IGEgZ3JlYXQgd2F5IHRvIGdldCBhbGwgb2YgdGhlbS4gU28gd2UgbmVlZCB0byBwYXJzZSB0aGUgaGVhZGVyIHN0cmluZ1xuICAgIC8vIHdlIGdldCBiYWNrLiBJdCBjb21lcyBpbiBhIHNpbXBsZSBlbm91Z2ggZm9ybWF0OlxuICAgIC8vXG4gICAgLy8gaGVhZGVyLW5hbWU6IHZhbHVlIGhlcmVcbiAgICAvLyBjb250ZW50LXR5cGU6IGFwcGxpY2F0aW9uL2pzb25cbiAgICAvLyBvdGhlci1oZWFkZXItaGVyZTogc29tZSwgb3RoZXIsIHZhbHVlcywgb3IsIHdoYXRldmVyXG4gICAgY29uc3QgYWxsSGVhZGVycyA9IHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKTtcbiAgICB0aGlzLnJlc3BvbnNlSGVhZGVycyA9IGFsbEhlYWRlcnNcbiAgICAgID8gLy8gU3BsaXQgdGhlIGhlYWRlciB0ZXh0IGludG8gbGluZXNcbiAgICAgICAgYWxsSGVhZGVycy5zcGxpdCgnXFxuJykucmVkdWNlKChoZWFkZXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBsaW5lKSA9PiB7XG4gICAgICAgICAgLy8gU3BsaXQgdGhlIGxpbmVzIG9uIHRoZSBmaXJzdCBcIjogXCIgYXNcbiAgICAgICAgICAvLyBcImtleTogdmFsdWVcIi4gTm90ZSB0aGF0IHRoZSB2YWx1ZSBjb3VsZFxuICAgICAgICAgIC8vIHRlY2huaWNhbGx5IGhhdmUgYSBcIjogXCIgaW4gaXQuXG4gICAgICAgICAgY29uc3QgaW5kZXggPSBsaW5lLmluZGV4T2YoJzogJyk7XG4gICAgICAgICAgaGVhZGVyc1tsaW5lLnNsaWNlKDAsIGluZGV4KV0gPSBsaW5lLnNsaWNlKGluZGV4ICsgMik7XG4gICAgICAgICAgcmV0dXJuIGhlYWRlcnM7XG4gICAgICAgIH0sIHt9KVxuICAgICAgOiB7fTtcblxuICAgIHRoaXMucmVzcG9uc2UgPSBnZXRYSFJSZXNwb25zZSh4aHIpO1xuICAgIGNvbnN0IHsgbG9hZGVkLCB0b3RhbCB9ID0gb3JpZ2luYWxFdmVudDtcbiAgICB0aGlzLmxvYWRlZCA9IGxvYWRlZDtcbiAgICB0aGlzLnRvdGFsID0gdG90YWw7XG4gIH1cbn1cbiJdfQ==
